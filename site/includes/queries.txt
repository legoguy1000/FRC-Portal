1. Average hours per person per year, Total hours per year
SELECT SUM(d.hours) as sum, AVG(d.hours) as avg, d.year from (SELECT a.user_id, SUM(time_to_sec(timediff(a.time_out, a.time_in)) / 3600) as hours, year(a.time_in) as year from meeting_hours a GROUP BY user_id,year) d GROUP BY year

2. Total hours per person per year (used as subquery 1 and 3)
SELECT a.user_id, SUM(time_to_sec(timediff(a.time_out, a.time_in)) / 3600) as hours, year(a.time_in) as year from meeting_hours a GROUP BY user_id,year

3. Average hours per user type per year / Total hours per user type per year
SELECT b.user_type, SUM(d.hours) as sum, AVG(d.hours) as avg, d.year from (SELECT a.user_id, SUM(time_to_sec(timediff(a.time_out, a.time_in)) / 3600) as hours, year(a.time_in) as year from meeting_hours a GROUP BY user_id,year) d LEFT JOIN users b USING (user_id) GROUP BY year,user_type

4. Total hours per user type per year
SELECT b.user_type, SUM(time_to_sec(timediff(a.time_out, a.time_in)) / 3600) as hours, year(a.time_in) as year from meeting_hours a LEFT JOIN users b USING (user_id) GROUP BY b.user_type,year

5. Average hours per user type per year with totals
SELECT b.user_type, SUM(d.hours) as sum, AVG(d.hours) as avg, d.year from (SELECT a.user_id, SUM(time_to_sec(timediff(a.time_out, a.time_in)) / 3600) as hours, year(a.time_in) as year from meeting_hours a GROUP BY user_id,year) d LEFT JOIN users b USING (user_id) GROUP BY year,user_type
UNION
SELECT b.user_type, SUM(d.hours) as sum, AVG(d.hours) as avg, 'ALL' AS year from (SELECT a.user_id, SUM(time_to_sec(timediff(a.time_out, a.time_in)) / 3600) as hours from meeting_hours a GROUP BY user_id) d LEFT JOIN users b USING (user_id) GROUP BY user_type





SELECT 	users.*,
		CONCAT(users.fname," ",users.lname) AS full_name,
		schools.school_name,
		reqs.*
		FROM users
		LEFT JOIN schools USING (school_id)
		LEFT JOIN (
			SELECT a.*,b.year FROM anual_requirements a LEFT JOIN seasons b USING (season_id) WHERE CURDATE() <= b.end_date
		) reqs USING (user_id)




SELECT a.*,b.*,c.*, (SELECT SUM(time_to_sec(timediff(d.time_out, d.time_in)) / 3600) FROM meeting_hours d GROUP BY d.user_id) AS hours, ((SELECT SUM(time_to_sec(timediff(d.time_out, d.time_in)) / 3600) FROM meeting_hours d GROUP BY d.user_id) >= (SELECT mentor from hour_requirements )) AS hours_met FROM `user_event_requirements` a LEFT JOIN users b USING (user_id) LEFT JOIN anual_requirements c USING (user_id)

SELECT b.*,c.*, hours.*, (hours.hours >= (SELECT mentor from hour_requirements)) as hours_met FROM users b
LEFT JOIN anual_requirements c USING (user_id)
LEFT JOIN (SELECT d.user_id, SUM(time_to_sec(timediff(d.time_out, d.time_in)) / 3600) AS hours FROM meeting_hours d GROUP BY d.user_id) AS hours USING (user_id)

12345
